<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Animated Math Solution</title>
    <style>
        :root {
            --notebook-blue: #0066cc;
            --paper-color: #fffdf0;
            --pen-color: #2b3d4f;
        }
        
        body {
            font-family: 'Comic Sans MS', sans-serif;
            background-color: #f0f0f0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }
        
        .notebook-container {
            width: 100%;
            max-width: 750px;
            background-color: var(--paper-color);
            border-radius: 8px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: hidden;
            padding: 40px 20px;
        }
        
        .notebook-header {
            text-align: center;
            margin-bottom: 20px;
            color: var(--pen-color);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }
        
        .exam-title {
            font-size: 18px;
            font-weight: bold;
            color: #333;
            margin-right: 10px;
        }
        
        .problem-statement {
            font-size: 20px;
            margin-top: 10px;
            font-weight: bold;
            color: #0066cc;
        }
        
        .notebook-paper {
            position: relative;
            padding: 10px;
        }
        
        .notebook-line {
            height: 80px;
            border-bottom: 1px solid #b5c7d5;
            position: relative;
            margin-bottom: 5px;
        }
        
        .notebook-line::before {
            content: '';
            position: absolute;
            left: -20px;
            top: 0;
            height: 100%;
            width: 1px;
            background-color: #ff9999;
        }
        
        .math-step {
            position: relative;
            opacity: 0;
            transform: translateY(10px);
            transition: opacity 0.8s, transform 0.8s;
            padding-left: 10px;
            font-size: 22px;
            color: var(--pen-color);
            height: 100%;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .math-step.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        .math-step-writing {
            color: var(--pen-color);
            position: relative;
            overflow: visible;
            display: inline-block;
            white-space: nowrap;
            width: 0;
        }
        
        .step-arrow {
            display: inline-block;
            margin: 0 10px;
            color: #4a90e2;
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        
        .step-arrow.visible {
            opacity: 1;
        }
        
        .step-explanation {
            color: #6b7d8c;
            font-size: 18px;
            margin-left: 30px;
            transform: scale(0.8);
            opacity: 0;
            transition: opacity 0.5s ease, transform 0.5s ease;
        }
        
        .step-explanation.visible {
            opacity: 1;
            transform: scale(1);
        }
        
        .final-answer {
            color: #e7305b;
            font-weight: bold;
        }
        
        .long-division {
            font-family: 'Courier New', monospace;
            font-size: 18px;
            line-height: 1.2;
            white-space: pre;
            margin: 10px 0;
            padding: 10px;
            background-color: #f8f9fa;
            border-radius: 5px;
            border: 1px solid #dee2e6;
        }
        
        .division-setup {
            position: relative;
            display: inline-block;
            font-family: 'Courier New', monospace;
            font-size: 20px;
            line-height: 1.4;
        }
        
        .division-bar {
            border-top: 2px solid #333;
            border-left: 2px solid #333;
            padding-left: 10px;
            padding-top: 5px;
        }
        
        .restart-btn {
            background-color: var(--notebook-blue);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 30px;
            font-family: inherit;
            font-size: 16px;
            cursor: pointer;
            margin-top: 20px;
            transition: background-color 0.3s, transform 0.2s;
            display: block;
            margin: 20px auto 0;
            opacity: 0;
            transform: scale(0.9);
        }
        
        .restart-btn:hover {
            background-color: #004e9e;
            transform: scale(1.05);
        }
        
        .restart-btn.visible {
            opacity: 1;
            transform: scale(1);
        }
        
        .pen-icon {
            position: absolute;
            width: 20px;
            height: 20px;
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 10;
        }
        
        @media (max-width: 600px) {
            .notebook-container {
                padding: 20px 10px;
            }
            
            .math-step {
                font-size: 20px;
            }
            
            .step-explanation {
                font-size: 16px;
                margin-left: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="notebook-container">
        <div class="notebook-header">
            <h1>How to Convert Fractions to Decimals</h1>
            <div class="problem-statement">Convert 3/8 to a decimal</div>
        </div>
        <div class="notebook-paper">
            <div class="notebook-line">
                <div class="math-step" id="step1">
                    <div class="math-step-writing">Convert 3/8 to decimal</div>
                </div>
            </div>
            <div class="notebook-line">
                <div class="math-step" id="step2">
                    <div class="math-step-writing">3 ÷ 8</div>
                    <div class="step-explanation">Divide numerator by denominator</div>
                </div>
            </div>
            <div class="notebook-line">
                <div class="math-step" id="step3">
                    <div class="math-step-writing">
                        <div class="division-setup">
                            <div>      0.375</div>
                            <div class="division-bar">8 ) 3.000</div>
                        </div>
                    </div>
                    <div class="step-explanation">Set up long division with decimal places</div>
                </div>
            </div>
            <div class="notebook-line">
                <div class="math-step" id="step4">
                    <div class="math-step-writing">
                        <div class="long-division">Step 1: 8 doesn't go into 3
Put 0 before decimal point</div>
                    </div>
                </div>
            </div>
            <div class="notebook-line">
                <div class="math-step" id="step5">
                    <div class="math-step-writing">
                        <div class="long-division">Step 2: 30 ÷ 8 = 3 remainder 6
        24  (8 × 3)
        ---
         6</div>
                    </div>
                    <div class="step-explanation">First decimal place: 3</div>
                </div>
            </div>
            <div class="notebook-line">
                <div class="math-step" id="step6">
                    <div class="math-step-writing">
                        <div class="long-division">Step 3: Bring down 0 → 60
60 ÷ 8 = 7 remainder 4
        56  (8 × 7)
        ---
         4</div>
                    </div>
                    <div class="step-explanation">Second decimal place: 7</div>
                </div>
            </div>
            <div class="notebook-line">
                <div class="math-step" id="step7">
                    <div class="math-step-writing">
                        <div class="long-division">Step 4: Bring down 0 → 40
40 ÷ 8 = 5 remainder 0
        40  (8 × 5)
        ---
         0</div>
                    </div>
                    <div class="step-explanation">Third decimal place: 5</div>
                </div>
            </div>
            <div class="notebook-line">
                <div class="math-step" id="step8">
                    <div class="math-step-writing">
                        <div class="division-setup">
                            <div>      0.375</div>
                            <div class="division-bar">8 ) 3.000</div>
                            <div>      0</div>
                            <div>     ---</div>
                            <div>      30</div>
                            <div>      24</div>
                            <div>     ---</div>
                            <div>       60</div>
                            <div>       56</div>
                            <div>      ---</div>
                            <div>        40</div>
                            <div>        40</div>
                            <div>       ---</div>
                            <div>         0</div>
                        </div>
                    </div>
                    <div class="step-explanation">Complete long division layout</div>
                </div>
            </div>
            <div class="notebook-line">
                <div class="math-step" id="step9">
                    <div class="math-step-writing">3/8 = 0.375</div>
                    <div class="step-explanation final-answer">Final answer - division complete!</div>
                </div>
            </div>
        </div>
        <button class="restart-btn" id="restartBtn">Watch Again</button>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Add pen icon to follow cursor
            const penIcon = document.createElement('div');
            penIcon.className = 'pen-icon';
            penIcon.innerHTML = '✏️';
            document.body.appendChild(penIcon);
            
            // Animation controller
            const steps = document.querySelectorAll('.math-step');
            const stepWritings = document.querySelectorAll('.math-step-writing');
            const explanations = document.querySelectorAll('.step-explanation');
            const restartBtn = document.getElementById('restartBtn');
            
            function animateWriting(element, finalWidth, duration, delay, callback) {
                setTimeout(() => {
                    let start = null;
                    const textContent = element.textContent;
                    const textWidth = Math.max(getTextWidth(textContent, window.getComputedStyle(element).font), 400);
                    
                    element.parentElement.classList.add('visible');
                    
                    function step(timestamp) {
                        if (!start) start = timestamp;
                        const elapsed = timestamp - start;
                        const progress = Math.min(elapsed / duration, 1);
                        
                        // Calculate cursor position for pen icon
                        const rect = element.getBoundingClientRect();
                        const cursorX = rect.left + (textWidth * progress) + 5;
                        const cursorY = rect.top + rect.height / 2;
                        
                        penIcon.style.opacity = 1;
                        penIcon.style.left = `${cursorX}px`;
                        penIcon.style.top = `${cursorY}px`;
                        
                        element.style.width = `${finalWidth * progress}px`;
                        
                        if (progress < 1) {
                            window.requestAnimationFrame(step);
                        } else {
                            setTimeout(() => {
                                penIcon.style.opacity = 0;
                                if (callback) callback();
                            }, 200);
                        }
                    }
                    
                    window.requestAnimationFrame(step);
                }, delay);
            }
            
            function getTextWidth(text, font) {
                const canvas = getTextWidth.canvas || (getTextWidth.canvas = document.createElement('canvas'));
                const context = canvas.getContext('2d');
                context.font = font;
                const metrics = context.measureText(text);
                return metrics.width;
            }
            
            function showExplanation(index, delay) {
                setTimeout(() => {
                    explanations[index].classList.add('visible');
                }, delay);
            }
            
            function startAnimation() {
                // Reset
                steps.forEach(step => step.classList.remove('visible'));
                stepWritings.forEach(writing => {
                    writing.style.width = '0';
                });
                explanations.forEach(explanation => explanation.classList.remove('visible'));
                restartBtn.classList.remove('visible');
                
                // Get final widths before animation
                const finalWidths = Array.from(stepWritings).map(el => {
                    el.style.width = 'auto';
                    const width = Math.max(el.offsetWidth, 500);
                    el.style.width = '0';
                    return width;
                });
                
                // Start the sequence with delays between steps
                const stepDelay = 3000; // 3 seconds between steps
                
                animateWriting(stepWritings[0], finalWidths[0], 1000, 500, () => {
                    setTimeout(() => {
                        animateWriting(stepWritings[1], finalWidths[1], 1200, 0, () => {
                            showExplanation(0, 200);
                            
                            setTimeout(() => {
                                animateWriting(stepWritings[2], finalWidths[2], 1200, 0, () => {
                                    showExplanation(1, 200);
                                    
                                    setTimeout(() => {
                                        animateWriting(stepWritings[3], finalWidths[3], 1200, 0, () => {
                                            showExplanation(2, 200);
                                            
                                            setTimeout(() => {
                                                animateWriting(stepWritings[4], finalWidths[4], 1200, 0, () => {
                                                    showExplanation(3, 200);
                                                    
                                                    setTimeout(() => {
                                                        animateWriting(stepWritings[5], finalWidths[5], 800, 0, () => {
                                                            showExplanation(4, 200);
                                                            
                                                            setTimeout(() => {
                                                                animateWriting(stepWritings[6], finalWidths[6], 1200, 0, () => {
                                                                    showExplanation(5, 200);
                                                                    
                                                                    setTimeout(() => {
                                                                        animateWriting(stepWritings[7], finalWidths[7], 1200, 0, () => {
                                                                            showExplanation(6, 200);
                                                                            
                                                                            setTimeout(() => {
                                                                                animateWriting(stepWritings[8], finalWidths[8], 1000, 0, () => {
                                                                                    showExplanation(7, 200);
                                                                                    
                                                                                    setTimeout(() => {
                                                                                        animateWriting(stepWritings[9], finalWidths[9], 1000, 0, () => {
                                                                                            showExplanation(8, 200);
                                                                                            
                                                                                            setTimeout(() => {
                                                                                                restartBtn.classList.add('visible');
                                                                                            }, 1000);
                                                                                        });
                                                                                    }, stepDelay);
                                                                                });
                                                                            }, stepDelay);
                                                                        });
                                                                    }, stepDelay);
                                                                });
                                                            }, stepDelay);
                                                        });
                                                    }, stepDelay);
                                                });
                                            }, stepDelay);
                                        });
                                    }, stepDelay);
                                });
                            }, stepDelay);
                        });
                    }, stepDelay);
                });
            }
            
            // Start animation when page loads
            startAnimation();
            
            // Restart button handler
            restartBtn.addEventListener('click', startAnimation);
        });
    </script>
</body>
</html>
