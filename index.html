<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Ratio Problem Animation</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      background-color: #f5f5f5;
      font-family: 'Comic Sans MS', cursive, sans-serif;
      max-width: 100%;
      overflow-x: hidden;
    }
    
    .chalkboard {
      width: 94%;
      max-width: 500px;
      height: auto;
      min-height: 550px;
      background-color: #2a623d;
      border-radius: 10px;
      box-shadow: 0 10px 20px rgba(0,0,0,0.3);
      position: relative;
      overflow-y: auto;
      padding: 20px 15px;
      margin: 10px auto;
    }
    
    .chalk-text {
      color: rgba(255, 255, 255, 0.9);
      font-size: 22px;
      line-height: 1.5;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
      opacity: 0;
      position: relative;
      margin: 25px 0;
      display: flex;
      align-items: flex-start;
      flex-wrap: wrap;
    }
    
    .chalk-text span {
      opacity: 0;
      font-family: 'Comic Sans MS', cursive, sans-serif !important;
    }
    
    .step-number {
      display: inline-block;
      width: 30px;
      height: 30px;
      background-color: rgba(255,255,255,0.2);
      border-radius: 50%;
      text-align: center;
      line-height: 30px;
      margin-right: 10px;
      font-weight: bold;
      flex-shrink: 0;
    }
    
    .chalk-dust {
      position: absolute;
      width: 3px;
      height: 3px;
      background-color: rgba(255,255,255,0.7);
      border-radius: 50%;
      pointer-events: none;
    }
    
    .controls {
      display: flex;
      justify-content: center;
      margin: 15px 0;
      position: fixed;
      bottom: 20px;
      right: 20px;
      z-index: 100;
    }
    
    .btn {
      background-color: #ff4d4d;
      color: white;
      border: none;
      padding: 8px 16px;
      margin: 0;
      border-radius: 30px;
      cursor: pointer;
      font-size: 16px;
      font-weight: bold;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      transition: transform 0.2s;
      font-family: 'Comic Sans MS', cursive, sans-serif !important;
    }
    
    .btn:hover {
      transform: translateY(-2px);
    }
    
    .btn:active {
      transform: translateY(1px);
    }
    
    .title {
      font-size: 28px;
      text-align: center;
      margin-bottom: 20px;
      font-family: 'Comic Sans MS', cursive, sans-serif !important;
    }

    .subtitle {
      font-size: 20px;
      text-align: center;
      margin-top: -10px;
      margin-bottom: 20px;
      font-family: 'Comic Sans MS', cursive, sans-serif !important;
    }

    .problem {
      font-size: 20px;
      text-align: center;
      margin-top: -10px;
      margin-bottom: 30px;
      font-family: 'Comic Sans MS', cursive, sans-serif !important;
    }

    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-2px); }
      75% { transform: translateX(2px); }
    }
    
    .highlight {
      position: relative;
      display: inline-block;
    }
    
    .highlight::after {
      content: '';
      position: absolute;
      left: 0;
      bottom: -2px;
      width: 100%;
      height: 8px;
      background-color: rgba(255, 255, 100, 0.4);
      border-radius: 4px;
      z-index: -1;
      transform: scaleX(0);
      transform-origin: left;
      transition: transform 0.5s ease;
    }

    /* For math expressions */
    .fraction {
      display: inline-block;
      vertical-align: middle;
      text-align: center;
      margin: 0 4px;
      font-family: 'Comic Sans MS', cursive, sans-serif !important;
    }
    .fraction .numerator {
      border-bottom: 2px solid white;
      padding: 0 3px;
      display: block;
      margin-bottom: 4px;
      font-family: 'Comic Sans MS', cursive, sans-serif !important;
    }
    .fraction .denominator {
      padding: 0 3px;
      display: block;
      font-family: 'Comic Sans MS', cursive, sans-serif !important;
    }
    .superscript {
      position: relative;
      font-size: 0.7em;
      top: -0.5em;
      font-family: 'Comic Sans MS', cursive, sans-serif !important;
    }
    .subscript {
      position: relative;
      font-size: 0.7em;
      bottom: -0.5em;
      font-family: 'Comic Sans MS', cursive, sans-serif !important;
    }
    .big-fraction {
      font-size: 24px;
      display: block;
      text-align: center;
      margin: 10px auto;
      max-width: 80%;
      font-family: 'Comic Sans MS', cursive, sans-serif !important;
    }
  </style>
</head>
<body>
  <div class="chalkboard">
    <div class="chalk-text title">
      <span>Ratio Problem</span>
    </div>
    
    <div class="chalk-text subtitle">
      <span>If x:y = 2:3, evaluate:</span>
    </div>
    
    <div class="chalk-text problem">
      <span>
        <div class="fraction big-fraction">
          <div class="numerator">x² - y²</div>
          <div class="denominator">y² + x²</div>
        </div>
      </span>
    </div>
    
    <div class="chalk-text">
      <span class="step-number">1</span>
      <span>If x:y = 2:3, then x = <span class="highlight">2k</span> and y = <span class="highlight">3k</span> for some value k</span>
    </div>
    
    <div class="chalk-text">
      <span class="step-number">2</span>
      <span>Substitute these values into the expression:</span>
    </div>
    
    <div class="chalk-text">
      <span class="step-number">3</span>
      <span>
        <div class="fraction">
          <div class="numerator">(2k)² - (3k)²</div>
          <div class="denominator">(3k)² + (2k)²</div>
        </div>
      </span>
    </div>
    
    <div class="chalk-text">
      <span class="step-number">4</span>
      <span>
        <div class="fraction">
          <div class="numerator">4k² - 9k²</div>
          <div class="denominator">9k² + 4k²</div>
        </div>
      </span>
    </div>
    
    <div class="chalk-text">
      <span class="step-number">5</span>
      <span>
        <div class="fraction">
          <div class="numerator">-5k²</div>
          <div class="denominator">13k²</div>
        </div>
      </span>
    </div>
    
    <div class="chalk-text">
      <span class="step-number">6</span>
      <span>Simplify by dividing out k²:</span>
    </div>
    
    <div class="chalk-text">
      <span class="step-number">7</span>
      <span>
        <div class="fraction">
          <div class="numerator">-5</div>
          <div class="denominator">13</div>
        </div>
        = -<div class="fraction">
          <div class="numerator">5</div>
          <div class="denominator">13</div>
        </div>
      </span>
    </div>
    
    <div class="chalk-text">
      <span class="step-number">✓</span>
      <span>The final answer is -<div class="fraction">
          <div class="numerator">5</div>
          <div class="denominator">13</div>
        </div></span>
    </div>
  </div>
  
  <div class="controls">
    <button class="btn" id="replay">Replay</button>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const lines = document.querySelectorAll('.chalk-text');
      let currentLine = 0;
      let dustInterval;
      
      // Check if we're on mobile
      const isMobile = window.innerWidth < 768;
      
      // Adjust step timing for mobile
      const stepDelay = isMobile ? 2000 : 3000;
      
      function animateText(element) {
        const spans = element.querySelectorAll('span');
        let index = 0;
        
        element.style.opacity = 1;
        
        function revealNextSpan() {
          if (index < spans.length) {
            const span = spans[index];
            span.style.opacity = 1;
            
            if (span.classList.contains('highlight')) {
              setTimeout(() => {
                const highlight = span.querySelector('::after');
                if (highlight) {
                  highlight.style.transform = 'scaleX(1)';
                }
              }, 300);
            }
            
            // Add shake animation to the current span
            span.style.animation = 'shake 0.3s ease';
            setTimeout(() => {
              span.style.animation = '';
            }, 300);
            
            index++;
            setTimeout(revealNextSpan, 300);
          } else {
            // Move to next line after a pause
            setTimeout(() => {
              if (currentLine < lines.length - 1) {
                currentLine++;
                // Ensure the next element is visible by scrolling to it
                const nextElement = lines[currentLine];
                if (nextElement) {
                  // Calculate position and scroll there
                  const rect = nextElement.getBoundingClientRect();
                  const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                  window.scrollTo({
                    top: scrollTop + rect.top - 100,
                    behavior: 'smooth'
                  });
                }
                animateText(lines[currentLine]);
              } else {
                // All lines finished
                clearInterval(dustInterval);
                highlightAnswers();
              }
            }, stepDelay);
          }
        }
        
        revealNextSpan();
      }
      
      function createChalkDust() {
        // Create chalk dust at a slower rate to match slower writing
        if (Math.random() > 0.5) return; // Only create dust 50% of the time
        
        const dust = document.createElement('div');
        dust.className = 'chalk-dust';
        
        const chalkboard = document.querySelector('.chalkboard');
        const activeLine = lines[currentLine];
        
        if (activeLine) {
          const rect = activeLine.getBoundingClientRect();
          const boardRect = chalkboard.getBoundingClientRect();
          
          // Position dust relative to the current line
          const x = Math.random() * rect.width + (rect.left - boardRect.left);
          const y = Math.random() * 10 + (rect.top - boardRect.top + rect.height / 2);
          
          dust.style.left = `${x}px`;
          dust.style.top = `${y}px`;
          
          chalkboard.appendChild(dust);
          
          // Animate dust falling
          let opacity = 0.7;
          let posY = y;
          
          const fallInterval = setInterval(() => {
            opacity -= 0.01;
            posY += 0.5;
            
            dust.style.opacity = opacity;
            dust.style.top = `${posY}px`;
            
            if (opacity <= 0) {
              clearInterval(fallInterval);
              dust.remove();
            }
          }, 20);
        }
      }
      
      function highlightAnswers() {
        // Highlight the final answer with a special effect
        const finalAnswer = lines[lines.length - 1];
        const highlights = document.querySelectorAll('.highlight');
        
        highlights.forEach(el => {
          const highlight = el.querySelector('::after');
          if (highlight) {
            highlight.style.transform = 'scaleX(1)';
          }
        });
        
        finalAnswer.style.transform = 'scale(1.05)';
        finalAnswer.style.textShadow = '0 0 10px rgba(255,255,100,0.8)';
      }
      
      function startAnimation() {
        // Reset everything
        lines.forEach(line => {
          line.style.opacity = 0;
          const spans = line.querySelectorAll('span');
          spans.forEach(span => span.style.opacity = 0);
          line.style.transform = '';
          line.style.textShadow = '';
        });
        
        // Clear any existing dust
        document.querySelectorAll('.chalk-dust').forEach(el => el.remove());
        
        // Reset line counter
        currentLine = 0;
        
        // Scroll to the top of the chalkboard
        document.querySelector('.chalkboard').scrollTop = 0;
        window.scrollTo({top: 0, behavior: 'smooth'});
        
        // Start chalk dust effect
        dustInterval = setInterval(createChalkDust, 100);
        
        // Start animation
        animateText(lines[currentLine]);
      }
      
      // Start on page load
      startAnimation();
      
      // Replay button
      document.getElementById('replay').addEventListener('click', startAnimation);
    });
  </script>
</body>
</html>
